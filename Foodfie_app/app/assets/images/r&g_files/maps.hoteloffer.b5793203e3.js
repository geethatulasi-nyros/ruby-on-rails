(window.$WP=window.$WP||[]).push({id:"@ta/maps.hoteloffer",d:["vendor-babel","vendor-react-libs","ta-platform","@ta/common.page-dates","@ta/common.page-guests","@ta/common.text","ta-common","@ta/hotels.pricing","@ta/common.poller","@ta/maps.fetch"],e:["./packages/maps/hoteloffer/entrypoint.jsx"],x:{"./packages/maps/hoteloffer/entrypoint.jsx":["HotelOffer","DeferredHotelOffer"]},m:{"./packages/maps/hoteloffer/entrypoint.jsx":function(e,t,r){"use strict";r.r(t);var o=r("@babel/runtime/helpers/esm/objectSpread"),n=r.n(o),a=r("react"),s=r("react-redux"),i=r("@ta/common.tracking"),l=r("@ta/common.features"),c=r("@ta/common.page-dates"),f=r("@ta/common.page-guests"),m=r("@ta/common.text"),p=r("@ta/styleguide.button"),u=r.n(p),g=r("@ta/styleguide.icon"),_=r("@ta/common.i18n"),h=r("@ta/hotels.pricing"),d=function e(t){var r=Object(h.findFirstOffer)(t.offers),o=Object(h.findWorstOffer)(t.offers),n=!!(o&&r&&.97*o.price>r.price);if(r){var s=Object(l.featureIsEnabled)("all_in_pricing_copy_test_3")&&t.nights>0&&t.guestInfo.rooms>0?_.globalize.formatCurrencyInteger(r.price/t.nights/t.guestInfo.rooms):_.globalize.formatCurrencyInteger(r.price),c=function e(o){t.preOfferClick&&t.preOfferClick(r),t.onOfferClick(o,r.offerClickToken),function e(t){t.stopPropagation()}(o)};return a.createElement("div",{className:"maps-hoteloffer-HotelOffer__container--ntAvP"},a.createElement("div",{className:"maps-hoteloffer-HotelOffer__leftContainer--3IKk_"},o&&n&&a.createElement(m.AutoResizer,{className:"maps-hoteloffer-HotelOffer__strikeThroughPrice--39MWQ",defaultFontSizePx:14,minFontSizePx:10},_.globalize.formatCurrencyInteger(o.price)),a.createElement("div",{onClick:c},a.createElement(m.AutoResizer,{className:"maps-hoteloffer-HotelOffer__price--1KSIO",defaultFontSizePx:t.priceSize,minFontSizePx:14},s),Object(l.featureIsEnabled)("all_in_pricing_copy_test_1")&&t.nights>1&&t.guestInfo.rooms>0&&a.createElement(m.AutoResizer,{className:"maps-hoteloffer-HotelOffer__pricing_mode_copy--3yQmm",defaultFontSizePx:12,minFontSizePx:10},Object(_.localize)("num_nights_for_cost",{nNumNights:t.nights,priceString:_.globalize.formatCurrencyInteger(r.price*t.nights*t.guestInfo.rooms)})),Object(l.featureIsEnabled)("all_in_pricing_copy_test_2")&&t.nights>0&&a.createElement("span",{className:"maps-hoteloffer-HotelOffer__pricing_mode_copy--3yQmm"},Object(_.localize)("for_num_nights",{nNumNights:t.nights})),Object(l.featureIsEnabled)("all_in_pricing_copy_test_3")&&t.nights>0&&a.createElement("span",{className:"maps-hoteloffer-HotelOffer__pricing_mode_copy--3yQmm"},Object(_.localize)("num_nights_for_cost",{nNumNights:t.nights,priceString:_.globalize.formatCurrencyInteger(r.price)}))),a.createElement("div",{className:"maps-hoteloffer-HotelOffer__vendorNameContainer--3f8ML",onClick:c},a.createElement("span",{className:"maps-hoteloffer-HotelOffer__vendorName--21NVV"},r.provider),!r.isInstantBook&&Object(l.featureIsEnabled)("wc_maps_hotel_cards_offsite_arrow")&&a.createElement(g.Icon,{name:"external-link-no-box",className:"maps-hoteloffer-HotelOffer__offsiteArrow--37Rrh"}))),a.createElement("div",{className:"maps-hoteloffer-HotelOffer__viewDealContainer--28Hc4"},a.createElement(i.ClickTracker,t.trackingProps,a.createElement(u.a,{size:"small",onClick:c},Object(_.localize)("view_deal")))))}var f=t.offers&&0===t.offers.length?Object(_.localize)("meta_ui_contact_hotel_c2b"):Object(_.localize)("no_availailability_from_partners");return a.createElement("div",{className:"maps-hoteloffer-HotelOffer__container--ntAvP"},a.createElement("span",{className:"maps-hoteloffer-HotelOffer__offerMessaging--NbMz-"},f))};d.defaultProps={offers:[],trackingProps:{module:"maps_hotel_offer",action:"commerce_click"},onOfferClick:function e(t,r){t.persist();var o=window.require;o&&o(["trjs!commerce/offerclick"],function(e){e.clickEvent(t.nativeEvent,t.currentTarget,r)})},preOfferClick:function e(){},nights:0,guestInfo:f.DEFAULT_GUEST_INFO,priceSize:20};var b=Object(s.connect)(function(e,t){var r=e&&e.travelerInfo&&e.travelerInfo.hotels||{},o=Object(c.decode)(r.stayDates),a=o.startDate,s=o.endDate,i=a&&s&&new c.CalendarDate(a).daysTo(new c.CalendarDate(s))||0,l=Object(f.decode)(r.guests);return n()({},t,{nights:i,guestInfo:l})})(d),v=r("@babel/runtime/helpers/esm/classCallCheck"),O=r.n(v),k=r("@babel/runtime/helpers/esm/createClass"),I=r.n(k),y=r("@babel/runtime/helpers/esm/possibleConstructorReturn"),E=r.n(y),N=r("@babel/runtime/helpers/esm/getPrototypeOf"),C=r.n(N),z=r("@babel/runtime/helpers/esm/inherits"),j=r.n(z),P=r("@babel/runtime/helpers/esm/assertThisInitialized"),H=r.n(P),S=r("@babel/runtime/helpers/esm/defineProperty"),w=r.n(S),x=r("@ta/common.poller"),D=r.n(x),F=r("@ta/styleguide.loading"),T=r("@ta/maps.fetch"),q=r.n(T),A=5,R=function(e){function t(){var e,r;O()(this,t);for(var o=arguments.length,n=new Array(o),s=0;s<o;s++)n[s]=arguments[s];return r=E()(this,(e=C()(t)).call.apply(e,[this].concat(n))),w()(H()(H()(r)),"state",{requestNumber:1}),w()(H()(H()(r)),"poll",function(){r.setState({requestNumber:r.state.requestNumber+1})}),w()(H()(H()(r)),"parseData",function(e,t){if(e){var o=e.hotels,n=e.hacStatus,a=n&&(n.isHacComplete||n.hacPercentComplete>90);if(o&&1===o.length){var s=o[0];return{offers:s.offers&&s.offers.filter(function(e){return!!e.providerInfo}).map(function(e){return{offerClickToken:e.offerClickToken,price:e.price,status:e.status,provider:e.providerInfo.name,isInstantBook:e.providerInfo.isInstantBook}}),complete:a||r.state.requestNumber>=A}}}return{offers:[],complete:!!t}}),w()(H()(H()(r)),"renderWithResponse",function(e){var t,o=e.loading,n=e.data;return t=n&&(n.complete||Object(h.findFirstOffer)(n.offers||[]))?a.createElement(b,{offers:n.offers||[],trackingProps:r.props.trackingProps}):a.createElement("div",{style:{width:"100%"}},a.createElement(F.LoadingSpinner,{size:"small"})),a.createElement(a.Fragment,null,a.createElement(D.a,{loading:o,complete:!!n&&n.complete,requestNumber:r.state.requestNumber,poll:r.poll}),t)}),r}return j()(t,e),I()(t,[{key:"render",value:function e(){var t=this.props,r=t.locationId,o=t.stayDates,n=t.guestInfo,s=this.state.requestNumber,i=0===this.props.servlet.trim().length?"WebComponentMap":this.props.servlet;return a.createElement(q.a,{url:"/data/1.0/mapsEnrichment/hotel/".concat(r,"?rn=").concat(s,"&rc=").concat(i,"&stayDates=").concat(o,"&guestInfo=").concat(n),parser:this.parseData},this.renderWithResponse)}}]),t}(a.PureComponent);w()(R,"defaultProps",{trackingProps:{module:"deferred_hotel_offer",action:"commerce_click"}});var W=Object(s.connect)(function(e,t){var r=e.travelerInfo&&e.travelerInfo.hotels,o="",n="";return r&&(o=r.stayDates,n=r.guests),{locationId:t.locationId,stayDates:o,servlet:e.route.page,guestInfo:n}})(R);r.d(t,"HotelOffer",function(){return b}),r.d(t,"DeferredHotelOffer",function(){return W})}}});
//# sourceMappingURL=maps.hoteloffer.b5793203e3.js.map