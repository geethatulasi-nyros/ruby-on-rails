(window.$WP=window.$WP||[]).push({id:"@ta/social.repost-action",d:["vendor-babel","vendor-react-libs","vendor-apollo-libs","ta-platform","@ta/common.webview","@ta/overlays.managers","@ta/social.feed","@ta/social.login-gate","@ta/social.onboarding-state","ta-common","@ta/tracking.interactions","@ta/social.blocks","@ta/overlays.toast"],e:["./packages/social/repost-action/repost-action.jsx"],x:{"./packages/social/repost-action/repost-action.jsx":["default","RepostAction"]},m:{"./packages/social/repost-action/repost-action.jsx":function(e,t,o){"use strict";o.r(t);var s=o("@babel/runtime/helpers/esm/extends"),r=o.n(s),a=o("@babel/runtime/helpers/esm/objectSpread"),n=o.n(a),i=o("@babel/runtime/helpers/esm/classCallCheck"),c=o.n(i),l=o("@babel/runtime/helpers/esm/createClass"),p=o.n(l),u=o("@babel/runtime/helpers/esm/possibleConstructorReturn"),m=o.n(u),d=o("@babel/runtime/helpers/esm/getPrototypeOf"),b=o.n(d),h=o("@babel/runtime/helpers/esm/inherits"),f=o.n(h),g=o("@babel/runtime/helpers/esm/assertThisInitialized"),v=o.n(g),P=o("@babel/runtime/helpers/esm/defineProperty"),_=o.n(P),k=o("react"),w=o("react-redux"),y=o("react-apollo"),O=o("@ta/common.classnames"),j=o.n(O),I=o("@ta/common.features"),T=o("@ta/common.i18n"),C=o("@ta/common.webview"),E=o("@ta/overlays.managers"),R=o("@ta/platform.import"),S=o("@ta/social.feed"),z=o("@ta/social.login-gate"),A=o("@ta/social.onboarding-state"),U=o("@ta/styleguide.icon"),N=o("@ta/tracking.interactions"),F=o("@ta/social.blocks"),M=o("@ta/common.routing"),x=o("@ta/overlays.toast"),B=function(e){function t(){var e,o;c()(this,t);for(var s=arguments.length,r=new Array(s),a=0;a<s;a++)r[a]=arguments[a];return o=m()(this,(e=b()(t)).call.apply(e,[this].concat(r))),_()(v()(v()(o)),"successToastMessage",{Review:Object(T.localize)("success_repost_review"),Photo:Object(T.localize)("success_repost_photo"),Video:Object(T.localize)("success_repost_video"),ForumPost:Object(T.localize)("success_repost_forum"),LinkPost:Object(T.localize)("success_repost_link"),Trip:Object(T.localize)("success_repost_trip"),MediaBatch:Object(T.localize)("success_repost_photos")}),o}return f()(t,e),p()(t,[{key:"createToast",value:function e(t,o,s){switch(o){case"success":return{node:this.successToastMessage[t],cta:k.createElement(M.Link,{href:s?"/Profile/".concat(s):"/Profile",to:{page:"Profile",username:s}},Object(T.localize)("view_repost"))};case"error":return{node:Object(T.localize)("repost_failure_message")};case"no_permission":return{node:k.createElement(F.NoPermissionToast,null)};default:return{node:""}}}},{key:"render",value:function e(){var t=this;return k.createElement(x.Toaster,null,function(e){return t.props.children(function(o,s,r){e(t.createToast(o,s,r))})})}}]),t}(k.Component),W=Object(R.deferredImport)("@ta/social.repost-uploader","RepostUploader"),L=function(e){function t(){var e,o;c()(this,t);for(var s=arguments.length,r=new Array(s),a=0;a<s;a++)r[a]=arguments[a];return o=m()(this,(e=b()(t)).call.apply(e,[this].concat(r))),_()(v()(v()(o)),"state",{loadModal:!1}),_()(v()(v()(o)),"repostToast",void 0),_()(v()(v()(o)),"repostCallback",function(e,t,s){o.repostToast&&o.repostToast(e,t,s),"success"===t&&o.props.attemptOnboarding&&o.props.setFireOnboarding(!1,"REPOST_ACTION")}),_()(v()(v()(o)),"checkPermissionForUser",function(e){if(e&&e.blockStatus){var t=e.blockStatus;if(t&&(t.isBlocking||t.isBlockingYou))return!1}return!0}),_()(v()(v()(o)),"checkPermissions",function(){return!(!o.checkPermissionForUser(o.props.actor)||o.props.repostPreviewProps&&!o.checkPermissionForUser(o.props.repostPreviewProps.actor))||("function"==typeof o.repostToast&&o.repostToast(o.props.repostPreviewProps.feedSectionItem.object.__typename,"no_permission"),!1)}),_()(v()(v()(o)),"name","RepostUploader:".concat(Math.random())),o}return f()(t,e),p()(t,[{key:"createRepostUploader",value:function e(){var t=this;if(!this.props.repostPreviewProps.member&&this.props.loggedInUserId){var o=[{id:this.props.loggedInUserId}];return k.createElement(y.Query,{query:S.ProfileQueryWithUserId,variables:{userIds:o},errorPolicy:"all"},function(e){var o=(e.data||{}).memberProfiles,s=void 0===o?null:o,a=s?s[0]:null,i=n()({},t.props),c=n()({},t.props.repostPreviewProps);return c.member=a,i.repostPreviewProps=c,k.createElement(W,r()({},i,{modalName:t.name,repostCallback:t.repostCallback}))})}return k.createElement(W,r()({},this.props,{modalName:this.name,repostCallback:this.repostCallback}))}},{key:"render",value:function e(){var t=this,o=this.props.socialStatistics&&this.props.socialStatistics.isReposted,s=this.props.repostPreviewProps.feedSectionItem.object.id,r=this.props.repostPreviewProps.feedSectionItem.object.__typename,a=k.createElement(k.Fragment,null,k.createElement(z.SocialLoginGate,{pid:40434},function(e){return k.createElement(E.Opener,{name:t.name},function(a){return k.createElement(N.InteractionLogger,null,function(n){return k.createElement("span",{onClick:function o(i){t.state.loadModal||t.setState({loadModal:!0}),t.props.onClick&&t.props.onClick(),C.NativeBridge.isNativeWebview()?s&&r&&C.NativeBridge.postToBridge("repost",1,{objectId:s,type:r}):(n(i,"repost"),e().then(t.checkPermissions).then(function(e){e&&a()}))},className:j()("social-repost-action-RepostAction__social_action--2Msgl",_()({},"social-repost-action-RepostAction__active--3uYgW",o))},k.createElement(U.Icon,{name:"repost",className:"social-repost-action-RepostAction__icon--2iAxG"}),k.createElement("span",{className:"ui_link ".concat("social-repost-action-RepostAction__text--3GPHP"," socialCTA")},o?Object(T.localize)("reposted"):Object(T.localize)("social_repost")))})})}),this.state.loadModal?this.createRepostUploader():null,k.createElement(B,null,function(e){t.repostToast=e}));return k.createElement(k.Fragment,null,Object(I.featureIsEnabled)("social_reposts")?a:null)}}]),t}(k.Component);_()(L,"defaultProps",{onClick:void 0,attemptOnboarding:!0});var G=Object(w.connect)(function(e){return{loggedInUserId:e.auth.loggedInUserId}},{setFireOnboarding:A.ACTIONS.setShouldFire})(L);o.d(t,"RepostAction",function(){return G}),t.default={}}}});
//# sourceMappingURL=social.repost-action.fec0ff68e8.js.map