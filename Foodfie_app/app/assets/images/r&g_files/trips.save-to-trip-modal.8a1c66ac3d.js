(window.$WP=window.$WP||[]).push({id:"@ta/trips.save-to-trip-modal",d:["vendor-babel","vendor-react-libs","ta-platform","@ta/trips.tracking","@ta/trips.trip-types","vendor-apollo-libs","@ta/trips.trip-util","@ta/trips.graphql","ta-common","@ta/trips.bookmark-icon","@ta/trips.privacy-icon","@ta/common.infinite-loader","@ta/social.show-more"],e:["./packages/trips/save-to-trip-modal/index.jsx"],x:{"./packages/trips/save-to-trip-modal/index.jsx":["SaveToTripContent"]},m:{"./packages/trips/save-to-trip-modal/index.jsx":function(e,t,r){"use strict";r.r(t);var o=r("@babel/runtime/helpers/esm/classCallCheck"),a=r.n(o),i=r("@babel/runtime/helpers/esm/createClass"),n=r.n(i),s=r("@babel/runtime/helpers/esm/possibleConstructorReturn"),l=r.n(s),c=r("@babel/runtime/helpers/esm/getPrototypeOf"),p=r.n(c),d=r("@babel/runtime/helpers/esm/inherits"),m=r.n(d),u=r("@babel/runtime/helpers/esm/assertThisInitialized"),v=r.n(u),f=r("@babel/runtime/helpers/esm/defineProperty"),_=r.n(f),b=r("react"),h=r("@ta/common.logging"),T=r.n(h),k=r("@ta/trips.tracking"),E=(r("@ta/trips.trip-types"),r("react-redux")),S=r("@ta/common.classnames"),C=r.n(S),w=r("@ta/common.tracking"),M=r("@ta/trips.trip-util"),I=r("@ta/common.infinite-loader"),g=r.n(I),B=r("@ta/social.show-more"),y=r("@ta/styleguide.icon"),O=r("@ta/common.i18n"),j=function e(t){return b.createElement(k.TripInteraction,{source:"trips",pageAsContext:!0},function(e){return b.createElement("div",{className:"trips-save-to-trip-modal-SaveToTripModalFooter__trip_stat_modal_footer--Am6hM",onClick:function r(){e({elementClick:{element:"stat_createTrip"}}),t.onClick()}},b.createElement(y.Icon,{name:"plus",className:"trips-save-to-trip-modal-SaveToTripModalFooter__trip_stat_modal_footer_button--Inxjt"}),b.createElement("span",{className:"trips-save-to-trip-modal-SaveToTripModalFooter__trip_stat_modal_footer_label--2_8Pc"},Object(O.localize)("stat_modal_create_a_trip_v2")))})},P=function(e){function t(){return a()(this,t),l()(this,p()(t).apply(this,arguments))}return m()(t,e),n()(t,[{key:"onCreateTripClicked",value:function e(){var t=this.props.onCreateTrip;t&&t()}},{key:"render",value:function e(){var t,r=this,o=this.props,a=o.tripList,i=o.savedSet,n=o.tripListBottom;if(0===a.length)return null;var s=a.slice().filter(function(e){var t=Object(M.isOwner)(e);return Object(M.getTripPermissions)(e,!!t).canAddItem});return b.createElement("div",{className:C()("trips-save-to-trip-modal-SaveToTripModalBase__trip_stat_modal--3FWrO",(t={},_()(t,"trips-save-to-trip-modal-SaveToTripModalBase__fullscreen_ie_safari_fix--2b2bW","IE"===this.props.browserFamily||"Safari"===this.props.browserFamily),_()(t,"trips-save-to-trip-modal-SaveToTripModalBase__disabled--1BenF",this.props.disabled),t))},b.createElement(w.Impression,{source:"trips",attributes:Object(k.getTripsImpression)({element:"statModal",trips:s,item:{saved:i.size>0}})},b.createElement(g.a,{loadMore:this.props.onPaginate,threshold:550,throttle:50,hasMore:this.props.hasMore,infiniteLoadOnMount:!1},function(e,t,o,a){return b.createElement("div",{className:"trips-save-to-trip-modal-SaveToTripModalBase__trip_stat_modal_list--3S6za",ref:e},b.createElement("ul",{ref:t},s.map(function(e){return b.createElement("li",{key:e.id},r.props.rowCreator(e))}),b.createElement("li",{className:"trips-save-to-trip-modal-SaveToTripModalBase__scrollButtonContainer--2HUgR"},b.createElement(B.ShowMore,{onClick:o,hasMore:r.props.hasMore,showButton:!a},null)),n&&b.createElement("li",{key:"bottom"},n)))})),b.createElement(j,{onClick:function e(){return r.onCreateTripClicked()}}))}}]),t}(b.PureComponent),N=Object(E.connect)(function(e){return{browserFamily:e.meta.device.browser.family}})(P),R=r("react-apollo"),x=r("@ta/trips.graphql"),z=r("@ta/common.features"),A=r("@ta/trips.bookmark-icon"),F=r("@ta/trips.privacy-icon"),L=r.n(F),U=function e(t){var r=t.trip,o=t.showBookmark,a=t.onClicked,i="PUBLIC"!==(r||{}).status;return b.createElement("div",{className:"trips-save-to-trip-modal-rows-SaveToTripModalRowBase__trip_stat_modal_item_container--JN5mn",onClick:function e(t){t.stopPropagation(),a()}},b.createElement("div",{className:"trips-save-to-trip-modal-rows-SaveToTripModalRowBase__image_container--2oLIu"},r.photo&&r.photo.photoSizes&&r.photo.photoSizes.length?b.createElement("img",{className:"trips-save-to-trip-modal-rows-SaveToTripModalRowBase__thumbnail--15C64",src:r.photo.photoSizes[1].url}):b.createElement("div",{className:"trips-save-to-trip-modal-rows-SaveToTripModalRowBase__thumbnail_placeholder--1pO8D"},b.createElement(y.Icon,{name:"suitcase"}))),b.createElement("div",{className:"trips-save-to-trip-modal-rows-SaveToTripModalRowBase__title_container--385YG"},!Object(z.featureIsEnabled)("saves_heart_with_wc_flow")&&b.createElement(L.a,{isPrivate:i,borderless:!0,size:"small",className:"trips-save-to-trip-modal-rows-SaveToTripModalRowBase__private_icon--aNWnU"}),b.createElement("span",{className:"trips-save-to-trip-modal-rows-SaveToTripModalRowBase__title_label--2r845"},r.title),o&&b.createElement("span",{className:"trips-save-to-trip-modal-rows-SaveToTripModalRowBase__save_icon--3Ecgm"},b.createElement(A.BookmarkIcon,{active:!0,bookmarkStyle:"flat",bookmarkSize:"22"}))))};U.defaultProps={showBookmark:!1};var D=U,W=function e(t){var r=t.trip,o=t.itemId,a=t.showBookmark,i=t.onClick,n=t.onError;return b.createElement(R.Mutation,{mutation:x.MoveTripItem},function(e){return b.createElement(D,{trip:r,onClicked:function t(){return function e(t){a||t({variables:{toTripId:r.id,itemId:o}}).then(function(e){var t=e&&e.data&&e.data.moveTripItem&&e.data.moveTripItem.errors;t&&t.length?n&&n():i&&i(r)}).catch(function(e){T.a.error(e)})}(e)},showBookmark:a})})};W.defaultProps={onError:function e(){}};var q=W,J=function e(t){var r=t.object,o=t.onClick,a=t.onUnsave,i=t.onError,n=t.trip;return b.createElement(R.Mutation,{mutation:x.RemoveTripReference,update:function e(t){return Object(M.updateSocialStatisticsOnUnsave)(t,r)}},function(e){return b.createElement(D,{trip:n,onClicked:function t(){return function e(t){o&&o(),t({variables:{reference:Object(M.toReference)(r),tripId:n.id}}).then(function(){a&&a(n,!1)}).catch(function(e){i&&i(e),T.a.error(e)})}(e)},showBookmark:!0})})};J.defaultProps={onClick:null,onUnsave:null};var V=J,$=function e(t){var r=t.trip,o=t.object,a=t.onSave,i=t.onError,n=t.onClick,s=function e(t){var r,o,a,i;return null==t?void 0:null===(r=t.data)||void 0===r?void 0:null===(o=r.addItemToTrip)||void 0===o?void 0:null===(a=o.errors)||void 0===a?void 0:null===(i=a[0])||void 0===i?void 0:i.error};return b.createElement(R.Mutation,{mutation:x.AddItemToTrip,update:function e(t,r){s(r)||Object(M.updateSocialStatisticsOnSave)(t,o)}},function(e){return b.createElement(D,{trip:r,onClicked:function t(){return function e(t){n&&n(),t({variables:{tripId:r.id,referenceId:"".concat(o.id),referenceType:o.type,allowDuplicates:!1,socialReference:Object(z.featureIsEnabled)("social_at_referencing_profile_links")}}).then(function(e){var t=s(e);t?i&&i({query:"ADD_ITEM_TO_TRIP",tripsError:t}):a&&a(r,!0)}).catch(function(e){i&&i({query:"ADD_ITEM_TO_TRIP"}),T.a.error(e)})}(e)}})})};$.defaultProps={onClick:null,onSave:null,onError:null};var G=$,H=function e(t){return"number"==typeof t.id?t.id:parseInt(t.id,10)},Y=function(e){function t(){var e,r;a()(this,t);for(var o=arguments.length,i=new Array(o),n=0;n<o;n++)i[n]=arguments[n];return r=l()(this,(e=p()(t)).call.apply(e,[this].concat(i))),_()(v()(v()(r)),"state",{disabled:!1}),_()(v()(v()(r)),"enableModal",function(){r.setState({disabled:!1})}),_()(v()(v()(r)),"disableModal",function(){r.setState({disabled:!0})}),_()(v()(v()(r)),"doCallback",function(e,t,o){var a=new Set(r.props.savedSet);o?a.add(t.id):a.delete(t.id),e&&e(t,o,a.size>0)}),_()(v()(v()(r)),"rowCreator",function(e,t){var o=r.props,a=o.saveObject,i=o.tripAction,n=o.savedSet,s=o.onError,l=H(a),c=n.has(e.id);if(c){var p=a&&b.createElement(V,{trip:e,object:a,onUnsave:function o(a,i){t({modalSuccess:{element:"unsave"}}),r.doCallback(r.props.onRemovedFromTrip,e,i)},onClick:r.disableModal,onError:r.enableModal});return p||T.a.error("Unable to determine item id for object ".concat(JSON.stringify(a)," and trip ").concat(e.id)),p}return"MOVE"===i?b.createElement(q,{trip:e,itemId:l,onClick:function e(t){r.disableModal(),r.doCallback(r.props.onMovedToTrip,t,!0)},showBookmark:c,onError:r.enableModal}):"SAVE"===i?b.createElement(G,{trip:e,object:a,onSave:function o(a,i){t({modalSuccess:{element:"stat"}}),r.doCallback(r.props.onSavedToTrip,e,i)},onError:function e(t){r.enableModal(),s&&s(t)},onClick:r.disableModal}):""}),r}return m()(t,e),n()(t,[{key:"render",value:function e(){var t=this;return b.createElement(k.TripInteraction,{source:"trips",pageAsContext:!0,saveObject:this.props.saveObject},function(e){return b.createElement(N,{tripList:t.props.tripList,savedSet:t.props.savedSet,hasMore:t.props.hasMore,tripListBottom:t.props.tripListBottom,rowCreator:function r(o){return t.rowCreator(o,e)},onCreateTrip:t.props.onCreateTrip,onPaginate:t.props.onPaginate,disabled:t.state.disabled})})}}]),t}(b.PureComponent);r.d(t,"SaveToTripContent",function(){return Y})}}});
//# sourceMappingURL=trips.save-to-trip-modal.8a1c66ac3d.js.map