(window.$WP=window.$WP||[]).push({id:"@ta/tracking.interactions",d:["vendor-babel","vendor-react-libs","vendor-apollo-libs","ta-platform","@ta/common.localstorage"],e:["./packages/tracking/interactions/interactions.jsx"],x:{"./packages/tracking/interactions/interactions.jsx":["InteractionLogger","TrackingNamespaceContext","ItemIdContext","FeedSectionIdContext","HomeTrackingContext","ProfileTrackingContext","InboxTrackingContext","SearchTrackingContext","OnboardingTrackingContext","UgcDetailTrackingContext","FollowPlacementContext","SocialHotelsTrackingContext","RecommendedFolloweesImpressionIdContext","MixerImpressionContext","FollowTabTypeContext","GlobalNavTrackingContext","LogInteractionV4"]},m:{"./packages/tracking/interactions/interactions.jsx":function(e,n,t){"use strict";t.r(n);var a=t("@babel/runtime/helpers/esm/extends"),i=t.n(a),r=t("@babel/runtime/helpers/esm/objectWithoutProperties"),o=t.n(r),c=t("@babel/runtime/helpers/esm/objectSpread"),l=t.n(c),u=t("react"),s=t("react-redux"),d=t("react-apollo"),m=t("@ta/common.decode"),f=t.n(m),k=t("@ta/common.localstorage"),g=t.n(k),v=t("@ta/common.logging"),C=t.n(v),p=u.createContext(null),x=u.createContext(null),b=u.createContext({itemId:""}),h=u.createContext(null),I=u.createContext(null),T=u.createContext(null),w=u.createContext(null),N=u.createContext(null),y=u.createContext(null),E=u.createContext(null),S=u.createContext(null),D=u.createContext(null),j={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"LogInteractions"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"interactions"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"InteractionWithTimestampInput"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"clientRequestTimestamp"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Long"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"logInteractions"},arguments:[{kind:"Argument",name:{kind:"Name",value:"interactions"},value:{kind:"Variable",name:{kind:"Name",value:"interactions"}}},{kind:"Argument",name:{kind:"Name",value:"clientRequestTimestamp"},value:{kind:"Variable",name:{kind:"Name",value:"clientRequestTimestamp"}}}],directives:[]}]}}],loc:{start:0,end:211}};j.loc.source={body:"2f6863dd8a7e"};var V=j,M=u.createContext(null),O=u.createContext(null),U=function e(n){var t=g.a.get("interactionData");t&&(n({variables:{interactions:t,clientRequestTimestamp:(new Date).getTime()}}),g.a.remove("interactionData"))},F=function e(n,t,a){!function e(n){var t=g.a.get("interactionData");t||(t=[]);var a={eventTimestampMsClient:(new Date).getTime(),interaction:n};t.push(a),g.a.set("interactionData",t)}(t),function e(n){if(!n)return!1;var t=n.target,a=n.currentTarget;if(t&&a&&t instanceof HTMLElement){var i=t,r=!1;do{if(i instanceof HTMLElement&&i.dataset.encodedUrl){var o=f()(i.dataset.encodedUrl),c=document.createElement("a");c.href=o,i.parentElement instanceof HTMLElement&&(c.style.display="none",i.parentElement.appendChild(c)),i=c}if(i instanceof HTMLAnchorElement){var l=i;if(window&&window.location&&window.location.hostname&&window.location.hostname===l.hostname)return!0}r=i===a||r,i=i.parentElement}while(i&&!r)}return!1}(n)||U(a)},L=function e(n){var t=n.logInteraction,a=o()(n,["logInteraction"]);return u.useEffect(function(){U(t)}),function e(n,t){return u.createElement(h.Consumer,null,function(e){return"mixer"===e?function e(n,t){var a=t.children;return u.createElement(p.Consumer,null,function(e){return u.createElement(x.Consumer,null,function(t){return u.createElement(b.Consumer,null,function(i){return a(function a(r,o,c){var l=c||{},u={};switch(o){case"delete":case"linkedPoiScroll":case"overflowMenuClick":case"report":case"seeAll":case"shelfScroll":case"untag":case"untagConfirm":case"untagCancel":u[o]={feedSectionId:t};break;case"linkedPhotoClick":u[o]={feedSectionId:t},Object.assign(u[o],l);break;case"linkedPoiClick":u[o]={feedSectionId:t,placement:"HEADER"},Object.assign(u[o],l);break;case"feedClick":case"helpful":case"repost":case"share":case"unhelpful":case"follow":case"unfollow":case"userClick":case"save":case"dismiss":case"userReferenceClick":case"linkReferenceClick":case"linkedSnippetClick":case"batchGalleryClick":case"batchGalleryScroll":u[o]={feedSectionId:t,itemId:i.itemId},Object.assign(u[o],l);break;case"showMore":u[o]={mixerImpressionId:e},Object.assign(u[o],l);break;default:var s=o||"undefined";C.a.error("Unknown mixer interaction type: ".concat(s))}F(r,{mixer:u},n)})})})})}(n,t):"home"===e?function e(n,t){var a=t.children;return u.createElement(I.Consumer,null,function(e){return u.createElement(y.Consumer,null,function(t){return a(function a(i,r,o){var c=o||{},u={};u["unfollow"===r?"unFollow":r]=l()({},e,c,t),F(i,{home:u},n)})})})}(n,t):"profile"===e?function e(n,t){var a=t.children;return u.createElement(T.Consumer,null,function(e){return u.createElement(y.Consumer,null,function(t){return a(function a(i,r,o){var c=o||{},u={};u["unfollow"===r?"unFollow":r]=l()({},e,c,t),F(i,{profile:u},n)})})})}(n,t):"onboarding"===e?function e(n,t){var a=t.children;return u.createElement(E.Consumer,null,function(e){return a(function t(a,i,r){var o=r||{},c={};c[i]=l()({},o,e),F(a,{onboarding:c},n)})})}(n,t):"inbox"===e?function e(n,t){var a=t.children;return u.createElement(D.Consumer,null,function(e){return a(function t(a,i,r){var o=r||{},c={};switch(i){case"follow":case"unfollow":c[i]={},Object.assign(c[i],o),Object.assign(c[i],e);break;default:var l=i||"undefined";C.a.error("Unknown or not set up inbox interactionType: ".concat(l))}F(a,{inbox:c},n)})})}(n,t):"search"===e?function e(n,t){var a=t.children;return u.createElement(w.Consumer,null,function(e){return a(function t(a,i,r){var o=r||{},c={};switch(i){case"follow":case"unfollow":c[i]={},Object.assign(c[i],o),Object.assign(c[i],e);break;default:var l=i||"undefined";C.a.error("Unknown or not set up search interactionType: ".concat(l))}F(a,{search:c},n)})})}(n,t):"ugcDetail"===e?function e(n,t){var a=t.children,i=t.loggedInUserId;return u.createElement(N.Consumer,null,function(e){return a(function t(a,r,o){var c=o||{},u=i?{actorUserId:i}:{},s={};s["feedClick"===r?"ugcClick":r]=l()({},e,c,u),F(a,{ugcDetail:s},n)})})}(n,t):"hotelReviewServlet"===e?function e(n,t,a){var i=t.children;return u.createElement(S.Consumer,null,function(e){return i(function t(i,r,o){var c=o||{},u={};u[r]=l()({},c,e);var s={};s[a]=u,F(i,s,n)})})}(n,t,e):"globalNav"===e?function e(n,t){var a=t.children;return u.createElement(M.Consumer,null,function(e){return a(function t(a,i,r){var o=r||{},c={};c[i]=l()({},o,e),F(a,{globalNav:c},n)})})}(n,t):"contentUploader"===e?function e(n,t){var a=t.children;return u.createElement(O.Consumer,null,function(e){return a(function t(a,i,r){var o=r||{},c={};c[i]=l()({},o,e),F(a,{contentUploader:c},n)})})}(n,t):t.children(function(){})})}(t,a)},R=Object(s.connect)(function(e){return{loggedInUserId:e.auth.loggedInUserId,isReadonlyMode:e.meta.readonlyMode}})(function e(n){return n.isReadonlyMode?n.children(function(){}):u.createElement(d.Mutation,{mutation:V},function(e){return u.createElement(L,i()({},n,{logInteraction:e}))})}),P=u.createContext(null),H=u.createContext(null),A={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"LogInteractionV4"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"interaction"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"InteractionV4Input"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"logInteractionV4"},arguments:[{kind:"Argument",name:{kind:"Name",value:"interaction"},value:{kind:"Variable",name:{kind:"Name",value:"interaction"}}}],directives:[]}]}}],loc:{start:0,end:111}};A.loc.source={body:"15da4aa6d267"};var q=A;t.d(n,"InteractionLogger",function(){return R}),t.d(n,"TrackingNamespaceContext",function(){return h}),t.d(n,"ItemIdContext",function(){return b}),t.d(n,"FeedSectionIdContext",function(){return x}),t.d(n,"HomeTrackingContext",function(){return I}),t.d(n,"ProfileTrackingContext",function(){return T}),t.d(n,"InboxTrackingContext",function(){return D}),t.d(n,"SearchTrackingContext",function(){return w}),t.d(n,"OnboardingTrackingContext",function(){return E}),t.d(n,"UgcDetailTrackingContext",function(){return N}),t.d(n,"FollowPlacementContext",function(){return P}),t.d(n,"SocialHotelsTrackingContext",function(){return S}),t.d(n,"RecommendedFolloweesImpressionIdContext",function(){return y}),t.d(n,"MixerImpressionContext",function(){return p}),t.d(n,"FollowTabTypeContext",function(){return H}),t.d(n,"GlobalNavTrackingContext",function(){return M}),t.d(n,"LogInteractionV4",function(){return q})}}});
//# sourceMappingURL=tracking.interactions.7469d715f0.js.map