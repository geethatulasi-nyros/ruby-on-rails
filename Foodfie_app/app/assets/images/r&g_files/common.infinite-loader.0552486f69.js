(window.$WP=window.$WP||[]).push({id:"@ta/common.infinite-loader",d:["vendor-babel","vendor-react-libs","ta-platform"],e:["./packages/common/infinite-loader/InfiniteLoader.jsx"],x:{"./packages/common/infinite-loader/InfiniteLoader.jsx":["default"]},m:{"./packages/common/infinite-loader/InfiniteLoader.jsx":function(e,n,t){"use strict";t.r(n);var r=t("@babel/runtime/helpers/esm/classCallCheck"),o=t.n(r),i=t("@babel/runtime/helpers/esm/createClass"),l=t.n(i),s=t("@babel/runtime/helpers/esm/possibleConstructorReturn"),a=t.n(s),c=t("@babel/runtime/helpers/esm/getPrototypeOf"),d=t.n(c),h=t("@babel/runtime/helpers/esm/inherits"),u=t.n(h),f=t("@babel/runtime/helpers/esm/assertThisInitialized"),m=t.n(f),p=t("@babel/runtime/helpers/esm/defineProperty"),b=t.n(p),L=t("react"),v=t("@ta/common.logging"),R=t.n(v),w=t("@ta/common.throttle"),M=t.n(w),g=8,S=function(e){function n(){var e,t;o()(this,n);for(var r=arguments.length,i=new Array(r),l=0;l<r;l++)i[l]=arguments[l];return t=a()(this,(e=d()(n)).call.apply(e,[this].concat(i))),b()(m()(m()(t)),"contentRef",L.createRef()),b()(m()(m()(t)),"containerRef",L.createRef()),b()(m()(m()(t)),"observer",void 0),b()(m()(m()(t)),"numberOfLoadMores",g),b()(m()(m()(t)),"infiniteScrollEnabled",!1),b()(m()(m()(t)),"isLoading",!1),b()(m()(m()(t)),"useWindow",function(){return!t.containerRef.current}),b()(m()(m()(t)),"isContentVisible",function(){if(!t.contentRef.current)return!1;var e=t.contentRef.current.getBoundingClientRect(),n=t.props.threshold;return t.useWindow()?window.innerHeight>=e.bottom-n:!(t.containerRef&&!t.containerRef.current)&&t.containerRef.current.getBoundingClientRect().bottom>=e.bottom-n}),b()(m()(m()(t)),"executeLoadMore",function(){return t.props.loadMore().catch(function(e){R.a.error("infinite loader error: ",e)}).then(function(){return t.numberOfLoadMores-=1,t.props.hasMore&&t.isContentVisible()&&t.numberOfLoadMores>0?t.executeLoadMore():(t.numberOfLoadMores<0&&R.a.error("Attempted to load more than 10 times without scroll handler, do you have an infinite loop?"),t.isLoading=!1,Promise.resolve())})}),b()(m()(m()(t)),"checkToLoadMore",function(){t.props.hasMore&&t.infiniteScrollEnabled&&t.isContentVisible()&&!t.isLoading&&(t.numberOfLoadMores=g,t.isLoading=!0,t.executeLoadMore())}),b()(m()(m()(t)),"enableInfiniteScroll",function(){t.infiniteScrollEnabled=!0,t.checkToLoadMore()}),b()(m()(m()(t)),"handleScroll",t.props.throttle?M()(t.checkToLoadMore,t.props.throttle,!1):t.checkToLoadMore),t}return u()(n,e),l()(n,[{key:"componentDidMount",value:function e(){this.useWindow()?(window.addEventListener("scroll",this.handleScroll),window.addEventListener("resize",this.handleScroll)):this.containerRef.current&&(this.containerRef.current.addEventListener("scroll",this.handleScroll),this.containerRef.current.addEventListener("resize",this.handleScroll)),this.props.infiniteLoadOnMount&&(this.infiniteScrollEnabled=!0,this.checkToLoadMore())}},{key:"componentWillUnmount",value:function e(){this.infiniteScrollEnabled=!1,this.useWindow()?(window.removeEventListener("scroll",this.handleScroll),window.removeEventListener("resize",this.handleScroll)):this.containerRef.current&&(this.containerRef.current.removeEventListener("scroll",this.handleScroll),this.containerRef.current.removeEventListener("resize",this.handleScroll))}},{key:"render",value:function e(){return this.props.children(this.containerRef,this.contentRef,this.enableInfiniteScroll,this.infiniteScrollEnabled)}}]),n}(L.Component);b()(S,"defaultProps",{throttle:200}),n.default=S}}});
//# sourceMappingURL=common.infinite-loader.0552486f69.js.map