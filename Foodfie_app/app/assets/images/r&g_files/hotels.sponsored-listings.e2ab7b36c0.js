(window.$WP=window.$WP||[]).push({id:"@ta/hotels.sponsored-listings",d:["vendor-babel","vendor-common","ta-platform"],e:["./packages/hotels/sponsored-listings/entrypoint.jsx"],x:{"./packages/hotels/sponsored-listings/entrypoint.jsx":["SponsoredListingTrackingEventHandlers"],"./packages/hotels/sponsored-listings/eventHandlers.jsx":["a"],"./packages/hotels/sponsored-listings/tripAdsEventTracker.jsx":["a","b","c"]},m:{"./node_modules/webpack/buildin/global.js":function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},"./packages/hotels/sponsored-listings/entrypoint.jsx":function(e,t,n){"use strict";n.r(t);var i=n("./packages/hotels/sponsored-listings/eventHandlers.jsx");n.d(t,"SponsoredListingTrackingEventHandlers",function(){return i.a})},"./packages/hotels/sponsored-listings/eventHandlers.jsx":function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return C});var i=n("@babel/runtime/helpers/esm/classCallCheck"),s=n.n(i),o=n("@babel/runtime/helpers/esm/createClass"),r=n.n(o),a=n("@babel/runtime/helpers/esm/defineProperty"),c=n.n(a),d=n("@babel/runtime/helpers/esm/objectWithoutProperties"),l=n.n(d),p=n("@babel/runtime/helpers/esm/objectSpread"),u=n.n(p),_=n("js-cookie"),g=n.n(_),m=n("@ta/common.logging"),f=n.n(m),k=n("@ta/common.tracking"),v=n("@ta/common.state"),b=n("./packages/hotels/sponsored-listings/tripAdsEventTracker.jsx"),h=function e(t,n,i,s,o){var r=t.sponsoredListing,a={};r&&(a={placement_slot_name:r.placement_slot_name,location_id:t.id,sponsored_type:r.sponsored_type,opportunity_uid:r.opportunity_uid,sl_line_item_id:r.sl_line_item_id,page_geo_id:n,chosen_location_id:t.id,listing_key:t.listingKey,trip_ads_select_guid:r.trip_ads_select_request_guid,trip_ads_id:r.trip_ads_id}),Object(k.trackEventWithContext)(i,s,u()({},a,o))},y=function e(t,n,i){var s=n.auth,o=n.meta,r=t.sponsoredListing;if(r){var a={is_member:s.isMember,device_type:o.device.userAgentCategory?o.device.userAgentCategory.toLowerCase():"",locationId:t.id,slot:r.placement_slot_name,trip_ads_select_guid:r.trip_ads_select_request_guid,listing_key:t.listingKey};Object(k.trackHolisticEvent)(i,a)}},E=function e(t,n){t.trip_ads_select_request_guid&&n(t.trip_ads_select_request_guid,t.opportunity_uid||"")},S=function e(){return window.JS_SECURITY_TOKEN},T=function e(){return{"content-type":"application/json","x-requested-by":S()}},j=function e(t,n,i,s,o,r){var a=n.route,c=t.sponsoredListing;if(c){var d={area:c.placement_slot_name,click_type:i,dest:s,from:a.page,impression_key:c.impression_key,is_backfill:!0,listing_key:t.listingKey,location_id:t.id,sl_line_item_id:c.sl_line_item_id,trip_ads_id:c.trip_ads_id,tt_placement:c.tt_placement,auction_offer_key:o};fetch(r?"/SponsoredListingCommerce/1.0/increment_click_metric":"/SponsoredListingCommerce/1.0/click",{method:"POST",headers:T(),credentials:"same-origin",body:JSON.stringify(d)}).then(function(e){return e.ok||f.a.debug("Did not get an ok. got: ".concat(e.statusText)),e}).catch(function(e){f.a.error("Error sending commerce click: ".concat(e.message))})}},C=function(){function t(){s()(this,t),c()(this,"visibleHandledHotels",new Set)}return r()(t,[{key:"clickHandler",value:function e(t){var n=t.sponsoredListing;if(n){var i=Object(v.getStore)().getState();!function e(t,n){var i=t.sponsoredListing;i&&h(t,n,"action","paid_backup_sponsored_listing_click",{ik:i.impression_key,tt_placement:i.tt_placement})}(t,i.page.geoId),y(t,i,k.holisticEvents.HOTELS_SP_CLICK),function e(t){var n=new Date;n.setTime(n.getTime()+1e4);var i={expires:n};g.a.set("sponsOppId",t.opportunity_uid,i),g.a.set("sponsLineItem",t.sl_line_item_id,i)}(n),j(t,i,"HR","Hotel_Review",null,!1),E(n,b.a)}}},{key:"visibleHandler",value:function e(t){var n=t.sponsoredListing;if(n&&!this.visibleHandledHotels.has(t.id)){this.visibleHandledHotels.add(t.id);var i=Object(v.getStore)().getState();!function e(t,n){h(t,n,"impression","paid_backup_sponsored_listing_displayed",{})}(t,i.page.geoId),y(t,i,k.holisticEvents.HOTELS_SP_IMPRESSION),E(n,b.c)}}},{key:"clearVisibleHistory",value:function e(){this.visibleHandledHotels.clear()}},{key:"offerClickHandler",value:function t(n,i){var s=n.sponsoredListing;if(s){var o=Object(v.getStore)().getState();!function t(n,i,s){var o=i.isInstantBook?"paid_backup_sponsored_ib_click":"paid_backup_sponsored_meta_click";e.require&&window.require(["trjs!commerce/offerclick"],function(e){var t=e.expandToken(i.offerClickToken),r=(t.url,l()(t,["url"]));h(n,s,"action",o,r)})}(n,i,o.page.geoId);var r=function t(n,i){if(e.require){var s=window.require("trjs!commerce/offerclick").expandToken(i.offerClickToken).slot;return!!n&&"DISCOVERY_META_PREFERENCE"===n.sponsored_type&&"1"===s}return!1}(s,i),a="DISCOVERY_META_PREFERENCE"!==s.sponsored_type||r,c=function t(n){return e.require?window.require("trjs!commerce/offerclick").expandToken(n.offerClickToken).ttAOK:""}(i);a&&j(n,o,i.isInstantBook?"IB":"META",i.provider,c,r),E(s,a?b.a:b.b)}}}]),t}()}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./packages/hotels/sponsored-listings/tripAdsEventTracker.jsx":function(e,t,n){"use strict";n.d(t,"a",function(){return c}),n.d(t,"b",function(){return d}),n.d(t,"c",function(){return l});var i=n("@ta/common.logging"),s=n.n(i),o=function e(){return window.JS_SECURITY_TOKEN},r=function e(){return{"content-type":"application/json","x-requested-by":o()}},a=function e(t,n,i){fetch("/data/1.0/tap/recordEvent",{method:"POST",headers:r(),credentials:"same-origin",body:JSON.stringify({eventType:i,requestGuid:t,externalId:n})}).then(function(e){return e.ok||s.a.error("Did not get an ok. got: ".concat(e.statusText)),e}).catch(function(e){s.a.error("Error sending TripAds click event: ".concat(e.message))})},c=function e(t,n){a(t,n,"CLICKED")},d=function e(t,n){a(t,n,"CLICKED_UNPAID")},l=function e(t,n){a(t,n,"IMPRESSED")}}}});
//# sourceMappingURL=hotels.sponsored-listings.e2ab7b36c0.js.map