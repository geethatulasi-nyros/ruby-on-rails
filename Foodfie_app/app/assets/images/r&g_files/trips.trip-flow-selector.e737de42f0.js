(window.$WP=window.$WP||[]).push({id:"@ta/trips.trip-flow-selector",d:["vendor-babel","vendor-react-libs","@ta/overlays.toast","@ta/common.webview","ta-platform","@ta/social.login-gate","@ta/social.onboarding-state","@ta/trips.saver","@ta/trips.trip-types","@ta/trips.trip-constants","@ta/trips.tracking","@ta/trips.trip-util","@ta/trips.trip-toasts","@ta/common.localstorage","@ta/overlays.managers","@ta/overlays.modal","@ta/overlays.headers","vendor-apollo-libs","ta-common","@ta/trips.create-trip-modal","@ta/trips.save-to-trip-modal","@ta/trips.graphql"],e:["./packages/trips/trip-flow-selector/index.jsx"],x:{"./packages/trips/trip-flow-selector/index.jsx":["TripFlowSelector","QueriedTripFlowSelector","RemoteSTATModalProvider"]},m:{"./packages/trips/trip-flow-selector/index.jsx":function(e,t,a){"use strict";a.r(t);var n=a("@babel/runtime/helpers/esm/toConsumableArray"),i=a.n(n),r=a("@babel/runtime/helpers/esm/classCallCheck"),o=a.n(r),s=a("@babel/runtime/helpers/esm/createClass"),l=a.n(s),d=a("@babel/runtime/helpers/esm/possibleConstructorReturn"),c=a.n(d),u=a("@babel/runtime/helpers/esm/getPrototypeOf"),p=a.n(u),m=a("@babel/runtime/helpers/esm/inherits"),v=a.n(m),k=a("@babel/runtime/helpers/esm/assertThisInitialized"),f=a.n(k),S=a("@babel/runtime/helpers/esm/defineProperty"),g=a.n(S),T=a("react"),b=a("react-redux"),h=a("@ta/overlays.toast"),y=a("@ta/common.webview"),N=a("@ta/common.routing"),E=a("@ta/social.login-gate"),C=a("@ta/social.onboarding-state"),I=a("@ta/common.tracking"),A=a.n(I),O=a("@ta/common.features"),F=a("@ta/trips.saver"),_=a.n(F),j=(a("@ta/trips.trip-types"),a("@ta/trips.trip-constants")),M=a("@ta/trips.tracking"),P=a("@ta/trips.trip-util"),D=a("@ta/trips.trip-toasts"),L=a("@ta/common.localstorage"),w=a.n(L),R=a("@babel/runtime/helpers/esm/extends"),V=a.n(R),x=a("@babel/runtime/helpers/esm/objectSpread"),U=a.n(x),Q=a("@ta/overlays.managers"),q=a("@ta/overlays.modal"),B=a("@ta/overlays.headers"),z=a("react-apollo"),W=a("@ta/styleguide.loading"),G=a("@ta/loading.error"),X=a("@ta/common.i18n"),Y=a("@ta/trips.create-trip-modal"),H=a("@ta/trips.save-to-trip-modal"),$={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"TripsStatQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"limit"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"offset"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"reference"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"TripReferenceInput"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"loadSavedTrips"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"paginatedTrips"},name:{kind:"Name",value:"tripsPaginated"},arguments:[{kind:"Argument",name:{kind:"Name",value:"limit"},value:{kind:"Variable",name:{kind:"Name",value:"limit"}}},{kind:"Argument",name:{kind:"Name",value:"offset"},value:{kind:"Variable",name:{kind:"Name",value:"offset"}}},{kind:"Argument",name:{kind:"Name",value:"userId"},value:{kind:"Variable",name:{kind:"Name",value:"userId"}}},{kind:"Argument",name:{kind:"Name",value:"reference"},value:{kind:"Variable",name:{kind:"Name",value:"reference"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"hasMore"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"trips"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"status"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"photoId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"photo"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"photoSizes"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"height"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"width"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"url"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"actionPermissions"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"canAddItem"},arguments:[],directives:[]}]}}]}}]}},{kind:"Field",alias:{kind:"Name",value:"savedTrips"},name:{kind:"Name",value:"tripsForReference"},arguments:[{kind:"Argument",name:{kind:"Name",value:"reference"},value:{kind:"Variable",name:{kind:"Name",value:"reference"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"include"},arguments:[{kind:"Argument",name:{kind:"Name",value:"if"},value:{kind:"Variable",name:{kind:"Name",value:"loadSavedTrips"}}}]}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:889}};$.loc.source={body:"6b84914dfa81"};var J=$,K={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"TripsReducedStatQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"limit"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"offset"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"paginatedTrips"},name:{kind:"Name",value:"tripsPaginated"},arguments:[{kind:"Argument",name:{kind:"Name",value:"limit"},value:{kind:"Variable",name:{kind:"Name",value:"limit"}}},{kind:"Argument",name:{kind:"Name",value:"offset"},value:{kind:"Variable",name:{kind:"Name",value:"offset"}}},{kind:"Argument",name:{kind:"Name",value:"userId"},value:{kind:"Variable",name:{kind:"Name",value:"userId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"hasMore"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"trips"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"status"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"photoId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"photo"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"photoSizes"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"height"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"width"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"url"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"actionPermissions"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"canAddItem"},arguments:[],directives:[]}]}}]}}]}}]}}],loc:{start:0,end:508}};K.loc.source={body:"7a1feacc4100"};var Z=K,ee=Object.freeze({DEFAULT:function e(){return Object(X.localize)("stat_modal_save_to_trip_v2")},CREATE:function e(){return Object(X.localize)("stat_modal_create_a_trip_v2")},SELECT:function e(){return Object(X.localize)("select_trip_header")},SELECT_CREATE:function e(){return Object(X.localize)("stat_modal_create_a_trip_v2")}}),te=function e(t){var a=Object(P.toReference)(t.saveObject),n=J,r="TripsStatQuery";return Object(O.featureIsEnabled)("trips_stat_attraction_product_reduced_query")&&"attractionProduct"===t.saveObject.type&&(n=Z,r="TripsReducedStatQuery"),T.createElement(z.Query,{query:n,notifyOnNetworkStatusChange:!0,fetchPolicy:"network-only",displayName:r,variables:{offset:0,limit:10,userId:t.userId,reference:a,loadSavedTrips:!0,socialReference:Object(O.featureIsEnabled)("social_at_referencing_profile_links")},onCompleted:t.onQueryComplete},function(e){var a,n=e.data,r=e.loading,o=e.error,s=e.refetch,l=e.fetchMore,d=(null==n?void 0:n.paginatedTrips)||{},c=d.trips,u=void 0===c?[]:c,p=d.hasMore,m=void 0===p||p,v=(n||{}).savedTrips,k=void 0===v?[]:v;r?a=T.createElement(W.LoadingSpinner,{size:"large"}):o&&(a=T.createElement(G.LoadingErrorMessage,{refetch:s}));var f=new Set(k.map(function(e){return e.id})),S={loadingNode:a,tripList:u,saveSet:f,hasMore:m,getMoreTrips:function e(){return l({variables:{offset:(null==u?void 0:u.length)||0,loadSavedTrips:!1},updateQuery:function e(t,a){var n=a.fetchMoreResult;return n?Object.assign({},t,{paginatedTrips:{trips:[].concat(i()(t.paginatedTrips.trips),i()(n.paginatedTrips.trips)),hasMore:n.paginatedTrips.hasMore,__typename:t.paginatedTrips.__typename},savedTrips:t.savedTrips}):t}})}};return t.children(S)})},ae=function(e){function t(e){var a;return o()(this,t),a=c()(this,p()(t).call(this,e)),g()(f()(f()(a)),"onModalClose",function(){a.props.onClose(),a.setSplashLoad(!0)}),g()(f()(f()(a)),"clearSplashLoad",function(){a.setSplashLoad(!1)}),a.state={splashLoad:!0},a}return v()(t,e),l()(t,[{key:"setSplashLoad",value:function e(t){this.state.splashLoad!==t&&this.setState({splashLoad:t})}},{key:"render",value:function e(){var t=this,a=ee[this.props.overlayState](),n=T.createElement(B.TitleBar,{iconName:"suitcase",displayType:"LEFT_ALIGN_GRAY"},a),i=this.props,r=i.loggedInUserId,o=i.saveObject,s=i.modalName;return T.createElement(q.Modal,{name:s,header:n,isFullBleed:!0,onClose:this.onModalClose},T.createElement(Q.Opener,{name:s},function(e,a){return T.createElement(Q.Closer,null,function(e){return T.createElement(te,{userId:r,saveObject:o,onQueryComplete:function e(){a&&t.clearSplashLoad()}},function(a){return a.loadingNode&&t.state.splashLoad?T.createElement("div",{className:"trips-trip-flow-selector-STATModal__loadingContainer--1tP79"},a.loadingNode):t.content(e,a)})})}))}},{key:"content",value:function e(t,a){var n=this,i=this.props,r=i.saveObject,o=i.lastSavedItem,s=i.trackingContext,l=i.onError,d=Object(P.toSavesObject)(o),c=T.createElement(M.TripInteraction,{source:"trips",trackingContext:s,pageAsContext:!0},function(e){return T.createElement("div",{className:"trips-trip-flow-selector-STATModal__modalPadding--36qa6"},T.createElement(Y.CreateTripWithAddItemModal,{object:r,onAddedToCreatedTrip:function a(i){n.props.statCallback("ADD","NEW",i,!0,!0),e({modalSuccess:{element:"stat"}}),t()},onError:l}))});switch(this.props.overlayState){case"DEFAULT":return 0===a.tripList.length?c:T.createElement(H.SaveToTripContent,{tripList:a.tripList,savedSet:a.saveSet,tripListBottom:a.loadingNode,onPaginate:a.getMoreTrips,hasMore:a.hasMore,saveObject:r,onCreateTrip:this.props.onCreateTripClicked,tripAction:"SAVE",onRemovedFromTrip:function e(a,i,r){n.props.statCallback("REMOVE","EXISTING",a,i,r),t()},onSavedToTrip:function e(a,i,r){n.props.statCallback("ADD","EXISTING",a,i,r),t()},onError:l});case"CREATE":return c;case"SELECT":return d?T.createElement(H.SaveToTripContent,{tripList:a.tripList,savedSet:a.saveSet,tripListBottom:a.loadingNode,onPaginate:a.getMoreTrips,hasMore:a.hasMore,saveObject:d,onCreateTrip:this.props.onCreateTripClicked,tripAction:"MOVE",onMovedToTrip:function e(a,i,r){n.props.statCallback("MOVE","EXISTING",a,i,r),t()},onRemovedFromTrip:function e(a,i,r){n.props.statCallback("REMOVE","EXISTING",a,i,r),t()},onError:l}):"";case"SELECT_CREATE":return o?T.createElement("div",{className:"trips-trip-flow-selector-STATModal__modalPadding--36qa6"},T.createElement(Y.CreateTripWithMoveItemModal,{item:o,onMovedToCreatedTrip:function e(a){n.props.statCallback("MOVE","NEW",a,!0,!0),t()}})):c;default:return""}}}]),t}(T.PureComponent),ne=T.createContext(void 0),ie=ne.Consumer,re=ne.Provider,oe=function(e){function t(e){var a;return o()(this,t),a=c()(this,p()(t).call(this,e)),g()(f()(f()(a)),"localModalSuffix","".concat(Math.random())),a.state={statProps:null,openCount:0,openModal:function e(){}},a}return v()(t,e),l()(t,[{key:"componentDidUpdate",value:function e(t,a){this.state.openCount>a.openCount&&this.state.openModal()}},{key:"setStatProps",value:function e(t,a){var n=a?{openModal:a,openCount:this.state.openCount+1}:{};this.setState(U()({statProps:t},n))}},{key:"render",value:function e(){var t=this,a=this.state.statProps,n=this.props,i=n.children,r=n.localStats,o=a||r,s=(o||{}).saveObject,l=void 0===s?{}:s,d="save-to-a-trip-modal-".concat(l.id,"-").concat(l.type,"-").concat(this.localModalSuffix),c=null===r?"RemoteStatModal":d;return T.createElement(T.Fragment,null,o&&T.createElement(ae,V()({},o,{modalName:c})),T.createElement(Q.Opener,{name:c},function(e){return T.createElement(Q.Closer,null,function(a){var n={name:c,open:e,close:a,setStatProps:t.setStatProps.bind(t)};return T.createElement(re,{value:n},i(n))})}))}}]),t}(T.PureComponent);g()(oe,"defaultProps",{localStats:null});var se=function(e){function t(){var e,a;o()(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return a=c()(this,(e=p()(t)).call.apply(e,[this].concat(i))),g()(f()(f()(a)),"remoteProps",null),a}return v()(t,e),l()(t,[{key:"displayChildren",value:function e(t){var a=this;return this.remoteProps=t,this.props.children(t.name,t.close,function e(n){var i=U()({},a.props.statProps,{overlayState:n||a.props.statProps.overlayState});t.setStatProps(i,t.open)}.bind(this))}},{key:"componentDidUpdate",value:function e(t){var a,n,i;(null==t?void 0:null===(a=t.statProps)||void 0===a?void 0:a.overlayState)!==(null===(n=this.props)||void 0===n?void 0:null===(i=n.statProps)||void 0===i?void 0:i.overlayState)&&this.remoteProps&&this.remoteProps.setStatProps(this.props.statProps)}},{key:"render",value:function e(){var t=this;return T.createElement(ie,null,function(e){return e?t.displayChildren(e):T.createElement(oe,{localStats:t.props.statProps},function(e){return t.displayChildren(e)})})}}]),t}(T.PureComponent),le=["Profile","HomeFeed","Trips","TripsWebview","Home"],de=function(e){function t(e){var a;return o()(this,t),a=c()(this,p()(t).call(this,e)),g()(f()(f()(a)),"launchToast",void 0),g()(f()(f()(a)),"removeToast",void 0),g()(f()(f()(a)),"onComplete",function(e){a.props.onComplete&&a.props.onComplete(e)}),g()(f()(f()(a)),"onModalClose",function(){a.setState({overlayState:"DEFAULT"})}),g()(f()(f()(a)),"onCreateTripClicked",function(){a.setState({overlayState:"CREATE"})}),g()(f()(f()(a)),"onSelectCreateTripClicked",function(){a.setState({overlayState:"SELECT_CREATE"})}),g()(f()(f()(a)),"onUndoRemoveAction",function(e){a.launchTripToast(Object(D.viewTripToast)(e,"SAVED")),a.setState({overlayState:"DEFAULT"}),a.onComplete(!0)}),g()(f()(f()(a)),"getFirstCommentBody",function(e){var t=e.comments;return t&&t.length>0?t[0].body:null}),g()(f()(f()(a)),"openFlow",function(e,t,n){return function(){return new Promise(function(i){var r=Object(P.toSavesObject)(a.props.object);if(r)if(y.NativeBridge.isNativeWebview()&&y.NativeBridge.isActionSupported("presentSavesModal",2)){var o=r.id,s=r.type,l=r.originalObject,d=a.getFirstCommentBody(a.props.object);y.NativeBridge.showSavesModal({id:o,type:s,note:d,originalObject:l&&{type:l.type,id:l.id}})}else n().then(function(){var n=a.getMostRecentlyAddedToTrip();!a.props.active&&n&&"savesItem"!==r.type?t(n):e(),i(a.state.overlayState)})})}}),g()(f()(f()(a)),"onSuccessfulAutosave",function(e,t,n){a.launchTripToast(Object(D.autoSavedToTripToast)(e,function e(){a.setState({overlayState:"SELECT"}),n("SELECT")},a.removeToast)),a.setState({overlayState:"DEFAULT",lastAutosavedItem:t}),a.onComplete(!0)}),g()(f()(f()(a)),"onSuccessfulSave",function(e,t){a.launchTripToast(Object(D.viewTripToast)(e,t)),a.setState({overlayState:"DEFAULT"}),a.setMostRecentlyAddedToTrip(e.id),a.props.attemptOnboarding&&a.props.setFireOnboarding(!1,"SAVE_ACTION"),a.onComplete(!0)}),g()(f()(f()(a)),"onSaveError",function(e){a.launchTripToast(Object(D.tripsErrorTripToast)(e))}),a.state={overlayState:"DEFAULT",lastAutosavedItem:null},a}return v()(t,e),l()(t,[{key:"launchTripToast",value:function e(t){this.launchToast&&this.launchToast.apply(this,i()(t))}},{key:"showUndoRemoveToast",value:function e(t){var a=Object(P.toSavesObject)(this.props.object);a&&this.launchTripToast(Object(D.removeFromTripToast)(t,a,this.onUndoRemoveAction))}},{key:"setMostRecentlyAddedToTrip",value:function e(t){w.a.set(j.MOST_RECENTLY_ADDED_TO_TRIP,{tripId:t,userId:this.props.loggedInUserId},144e5)}},{key:"getMostRecentlyAddedToTrip",value:function e(){var t=w.a.get(j.MOST_RECENTLY_ADDED_TO_TRIP);return t&&t.userId===this.props.loggedInUserId?t.tripId:null}},{key:"render",value:function e(){var t=this;if(!Object(O.featureIsEnabled)("trips_bookmark"))return null;var a=this.props,n=a.children,i=a.object,r=a.preventInteractionPropagation,o=a.trackingContext,s=a.loggedInUserId,l=Object(P.toSavesObject)(i);if(!l)return null;var d={modalName:"",saveObject:l,loggedInUserId:s,overlayState:this.state.overlayState,lastSavedItem:this.state.lastAutosavedItem,trackingContext:o,onCreateTripClicked:this.onCreateTripClicked,onClose:this.onModalClose,onError:this.onSaveError,statCallback:function e(a,n,i,r,o){"REMOVE"===a?(t.showUndoRemoveToast(i),t.onComplete(o)):"NEW"===n?t.onSuccessfulSave(i,"CREATED"):r&&t.onSuccessfulSave(i,"SAVED")}};return T.createElement(N.RouteConsumer,null,function(e){var a=e.route;return T.createElement(T.Fragment,null,T.createElement(M.TripInteraction,{source:"trips",trackingContext:o,saveObject:l,pageAsContext:!0},function(e,i){return T.createElement(E.SocialLoginGate,{tracking:{source:"trips",element:"ITEM_SAVE_LOGIN",attributes:{context:a?Object(M.getInteractionsContext)(a.page):void 0,puid:i}},pid:a&&a.page&&le.includes(a.page)?40439:39766},function(i){return T.createElement(se,{statProps:d},function(o,s,d){return T.createElement(T.Fragment,null,T.createElement(_.a,{object:l,onSave:function a(n,i){e({modalSuccess:{element:"quickSave"}}),t.onSuccessfulAutosave(n,i,d)},onError:t.onSaveError},function(o){return T.createElement("span",{onClick:function n(i){i.stopPropagation(),i.preventDefault(),r||e({elementClick:{element:"item_save"}});var o=t.props.active?"is_saved":"not_saved";A()({action:"saveCTA_click",module:"Trips|".concat(a.page),context:"Trips|".concat(l.type,"|").concat(o)})}},n(t.openFlow(d,o,i)))}))})})}),T.createElement(h.Toaster,null,function(e,a){return t.launchToast=e,t.removeToast=a,null}))})}}]),t}(T.Component);g()(de,"defaultProps",{preventInteractionPropagation:!1,attemptOnboarding:!0,onComplete:null,trackingContext:void 0});var ce=Object(b.connect)(function(e){return{loggedInUserId:e.auth.loggedInUserId}},{setFireOnboarding:C.ACTIONS.setShouldFire})(de),ue=a("@ta/common.logging"),pe=a.n(ue),me=a("@ta/trips.graphql"),ve=new(a("@ta/common.state").PrivateStateAccessor)("is-saved-state",{savedMap:{}}),ke=function e(t,a){return"".concat(t).concat(a)},fe={updateSaved:function e(t,a,n){return ve.action({type:"UPDATE_SAVED",saveId:t,saveType:a,isSaved:n})}};ve.setReducerIfUnset(function(e,t){var a=e.savedMap,n=t.saveId,i=t.saveType,r=t.isSaved,o=t.type,s=U()({},a);return n&&i&&"UPDATE_SAVED"===o&&(s[ke(n,i)]=r),{savedMap:s}});var Se=function e(t,a){return!0===t||!1===t?t:a},ge=function e(t){if(!Object(O.featureIsEnabled)("trips_bookmark"))return null;var a=t.object,n=t.preventInteractionPropagation,i=t.trackingContext,r=t.children,o=t.isActive,s=t.updateSaved,l=t.ssr,d=Object(P.toSavesObject)(a);if(!d)return pe.a.error("An invalid saves object was passed to QueriedTripFlowSelector"),null;var c=Object(P.objectStatisticQuery)(d)||{},u=c&&null==Se(o,null);return T.createElement(z.Query,{query:c.query,variables:c.variables,ssr:l,skip:!u,onCompleted:function e(t){if(u){var a=t&&t.savesObjects&&t.savesObjects[0];if(a){var n=function e(t,a){return t===me.LocationStatistics?a.locationId:t===me.AttractionStatistics?a.attractionProductId:a.id}(c.query,a),i=a.socialStatistics,r=void 0===i?{}:i,o=n===d.id&&!!r.isSaved;s(d.id,d.type,o)}}}},function(){return T.createElement(ce,{object:a,active:!!o,preventInteractionPropagation:n,trackingContext:i,onComplete:function e(t){s(d.id,d.type,t)}},function(e){return r(e,!!o)})})};ge.defaultProps={object:null,ssr:!1,trackingContext:void 0};var Te=Object(b.connect)(function(e,t){var a=function e(t,a){var n=a?ke(a.id,a.type):"";return ve.getFrom(t).savedMap[n]}(e,Object(P.toSavesObject)(t.object)),n=function e(t){return t&&t.socialStatistics&&t.socialStatistics.isSaved}(t.object),i=Se(a,n);return U()({},t,{loggedInUserId:e.auth.loggedInUserId,isActive:i})},{updateSaved:fe.updateSaved})(ge);a.d(t,"TripFlowSelector",function(){return ce}),a.d(t,"QueriedTripFlowSelector",function(){return Te}),a.d(t,"RemoteSTATModalProvider",function(){return oe})}}});
//# sourceMappingURL=trips.trip-flow-selector.e737de42f0.js.map