(window.$WP=window.$WP||[]).push({id:"@ta/hotels.photos",d:["vendor-babel","vendor-react-libs","vendor-apollo-libs","vendor-common","ta-platform","@ta/common.accumulating-provider","ta-common","@ta/styleguide.skeleton"],e:["./packages/hotels/photos/photos.jsx"],x:{"./packages/hotels/photos/FavouritePhotos.fragment.gql":["a"],"./packages/hotels/photos/photos.jsx":["CarouselPagingProvider","PAGE_SIZE","AlbumThumbnail","FavouritePhotosQuery","FavouritePhotosWithPanoCountQuery","OrderedPhotosQuery","ResponsiveDefaultImage"]},m:{"./packages/hotels/photos/FavouritePhotos.fragment.gql":function(e,t,i){"use strict";var n={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"FavouritePhotos"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"LocationInformation"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"locationId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"photoCount"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"mediaCount"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"thumbnail"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"photoSizes"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"width"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"height"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"url"},arguments:[],directives:[]}]}}]}},{kind:"Field",alias:{kind:"Name",value:"favouriteAlbum"},name:{kind:"Name",value:"albums"},arguments:[{kind:"Argument",name:{kind:"Name",value:"albumIds"},value:{kind:"ListValue",values:[{kind:"IntValue",value:"109"}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"totalCount"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"photos"},arguments:[{kind:"Argument",name:{kind:"Name",value:"page"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"offset"},value:{kind:"Variable",name:{kind:"Name",value:"offset"}}},{kind:"ObjectField",name:{kind:"Name",value:"limit"},value:{kind:"Variable",name:{kind:"Name",value:"limit"}}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"photoSizes"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"width"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"height"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"url"},arguments:[],directives:[]}]}}]}}]}}]}}],loc:{start:0,end:378}};n.loc.source={body:"4de61269ca84"},t.a=n},"./packages/hotels/photos/photos.jsx":function(e,t,i){"use strict";i.r(t);var n=i("@babel/runtime/helpers/esm/toConsumableArray"),a=i.n(n),o=i("@babel/runtime/helpers/esm/classCallCheck"),l=i.n(o),d=i("@babel/runtime/helpers/esm/createClass"),u=i.n(d),r=i("@babel/runtime/helpers/esm/possibleConstructorReturn"),s=i.n(r),m=i("@babel/runtime/helpers/esm/getPrototypeOf"),v=i.n(m),c=i("@babel/runtime/helpers/esm/inherits"),k=i.n(c),h=i("@babel/runtime/helpers/esm/assertThisInitialized"),f=i.n(h),p=i("@babel/runtime/helpers/esm/defineProperty"),g=i.n(p),N=i("react"),b=i("react-apollo"),S=i("lodash/get"),C=i.n(S),P=i("@ta/common.state"),F=i("@ta/common.accumulating-provider"),y=i.n(F),I=i("@ta/media.common"),V={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"FavouritePhotosWithFilter"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"LocationInformation"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"locationId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"photoCount"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"mediaCount"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"thumbnail"},arguments:[{kind:"Argument",name:{kind:"Name",value:"filter"},value:{kind:"Variable",name:{kind:"Name",value:"filter"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"photoSizes"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"width"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"height"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"url"},arguments:[],directives:[]}]}}]}},{kind:"Field",alias:{kind:"Name",value:"favouriteAlbum"},name:{kind:"Name",value:"albums"},arguments:[{kind:"Argument",name:{kind:"Name",value:"albumIds"},value:{kind:"ListValue",values:[{kind:"IntValue",value:"109"}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"totalCount"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"photos"},arguments:[{kind:"Argument",name:{kind:"Name",value:"page"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"offset"},value:{kind:"Variable",name:{kind:"Name",value:"offset"}}},{kind:"ObjectField",name:{kind:"Name",value:"limit"},value:{kind:"Variable",name:{kind:"Name",value:"limit"}}}]}},{kind:"Argument",name:{kind:"Name",value:"filter"},value:{kind:"Variable",name:{kind:"Name",value:"filter"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"photoSizes"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"width"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"height"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"url"},arguments:[],directives:[]}]}}]}}]}}]}}],loc:{start:0,end:422}};V.loc.source={body:"95d98115c557"};var T=V,A={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"FavouritePhotosWithPanoCount"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"locationId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"offset"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},defaultValue:{kind:"IntValue",value:"0"},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"limit"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},defaultValue:{kind:"IntValue",value:"10"},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"filter"}},type:{kind:"NamedType",name:{kind:"Name",value:"FilterInput"}},defaultValue:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"mediaGroup"},value:{kind:"EnumValue",value:"ALL_UNRESTRICTED"}}]},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"locations"},arguments:[{kind:"Argument",name:{kind:"Name",value:"locationIds"},value:{kind:"ListValue",values:[{kind:"Variable",name:{kind:"Name",value:"locationId"}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"locationId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"panoramaAlbum"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"totalCount"},arguments:[],directives:[]}]}},{kind:"FragmentSpread",name:{kind:"Name",value:"FavouritePhotosWithFilter"},directives:[]}]}}]}}],loc:{start:0,end:349}};A.loc.source={body:"3568ffe5fc5b"};var D={};A.definitions=A.definitions.concat(function O(e){return e.filter(function(e){if("FragmentDefinition"!==e.kind)return!0;var t=e.name.value;return!D[t]&&(D[t]=!0,!0)})}(T.definitions));var w=A,x={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"OrderedPhotosQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"locationId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"offset"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},defaultValue:{kind:"IntValue",value:"0"},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"limit"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},defaultValue:{kind:"IntValue",value:"10"},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"filter"}},type:{kind:"NamedType",name:{kind:"Name",value:"FilterInput"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"locations"},arguments:[{kind:"Argument",name:{kind:"Name",value:"locationIds"},value:{kind:"ListValue",values:[{kind:"Variable",name:{kind:"Name",value:"locationId"}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"locationId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"photoCount"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"mediaCount"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"photos"},arguments:[{kind:"Argument",name:{kind:"Name",value:"ordering"},value:{kind:"EnumValue",value:"BIG_CAROUSEL_MGMT"}},{kind:"Argument",name:{kind:"Name",value:"page"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"offset"},value:{kind:"Variable",name:{kind:"Name",value:"offset"}}},{kind:"ObjectField",name:{kind:"Name",value:"limit"},value:{kind:"Variable",name:{kind:"Name",value:"limit"}}}]}},{kind:"Argument",name:{kind:"Name",value:"filter"},value:{kind:"Variable",name:{kind:"Name",value:"filter"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"photoSizes"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"width"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"height"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"url"},arguments:[],directives:[]}]}}]}}]}}]}}],loc:{start:0,end:388}};x.loc.source={body:"84dd3aabdb28"};var E=x,j=i("@babel/runtime/helpers/esm/objectSpread"),Q=i.n(j),R={},z=new P.PrivateStateAccessor("carousel-paging-provider",R);z.setReducer(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:R,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"registerState":var i=t.uniqueId,n={totalPhotoCount:t.totalPhotoCount,panoCount:t.panoCount,fetchTarget:t.fetchTarget,favouritePhotoCount:t.favouritePhotoCount,loadedPhotoCount:t.loadedPhotoCount,photos:t.photos},a=Q()({},e);return a[i]=n,a;default:return e}});var _=function e(t){return function e(t){return z.getFrom(t)}(Object(P.getStore)().getState())[t]},q=function e(t){return t.filter(function(e,t,i){return t===i.findIndex(function(t){return t.id===e.id})})},L=function(e){function t(e){var i;l()(this,t),i=s()(this,v()(t).call(this,e)),g()(f()(f()(i)),"getUniqueId",function(){return i.props.uniqueId?i.props.uniqueId:"".concat(i.props.locationId)}),g()(f()(f()(i)),"getNextPageWithFetchTarget",function(e){e<(i.totalPhotoCount||0)+(i.favouritePhotoCount||0)&&(i.favouritePhotoCount&&i.loadedPhotoCount>i.favouritePhotoCount&&i.loadedPhotoCount<i.favouritePhotoCount+i.props.pageSize?i.setState({fetchTarget:i.favouritePhotoCount+i.props.pageSize}):i.setState({fetchTarget:e+i.props.pageSize}))}),g()(f()(f()(i)),"getNextPage",function(){i.getNextPageWithFetchTarget(i.state.fetchTarget)}),g()(f()(f()(i)),"getPhotos",function(e,t){var n=C()(e,"photos",void 0);n||(n=C()(e,"favouriteAlbum[0].photos",void 0)),n=n||[],i.loadedPhotoCount+=n.length,i.validateNumberOrThrow(i.loadedPhotoCount,"loadedPhotoCount");var o=C()(e,"thumbnail",void 0);return t&&o&&o.id&&(n=[o].concat(a()(n.filter(function(e){return e.id!==o.id})))),n}),g()(f()(f()(i)),"getNextQueryParams",function(){i.validateNumberOrThrow(i.state.fetchTarget,"fetchTarget");var e=Math.max(i.state.fetchTarget-i.loadedPhotoCount,0);if(i.validateNumberOrThrow(e,"limit"),0===e)return null;var t=i.shouldUseFavouritesQuery()?i.loadedPhotoCount:i.loadedPhotoCount-(i.favouritePhotoCount||0);i.validateNumberOrThrow(t,"offset");var n=Object(I.getMediaFilterToRetrieveAllPhotos)();return{locationId:i.props.locationId,offset:t,limit:e,filter:n}}),g()(f()(f()(i)),"shouldUseFavouritesQuery",function(){return null===i.favouritePhotoCount||i.loadedPhotoCount<i.favouritePhotoCount}),g()(f()(f()(i)),"parseQueryData",function(e,t){var n=[],o=C()(t,"locations[0]",void 0);if(!e&&o){if(null===i.totalPhotoCount){var l=C()(o,"thumbnail",null)?C()(o,"photoCount",0):0;i.panoCount=C()(o,"panoramaAlbum.totalCount",0),i.totalPhotoCount=Math.max(l-i.panoCount,0),i.validateNumberOrThrow(i.totalPhotoCount,"totalPhotoCount")}null===i.favouritePhotoCount&&(i.favouritePhotoCount=C()(o,"favouriteAlbum[0].totalCount",0),i.validateNumberOrThrow(i.favouritePhotoCount,"favouritePhotoCount"));var d=i.getPhotos(o,0===i.photos.length);n=i.wasJustInitialized?q([].concat(a()(i.photos),a()(d))):d,i.shouldSaveReduxState=!0}return n}),g()(f()(f()(i)),"validateNumberOrThrow",function(e,t){if("number"!=typeof e||isNaN(e)||e<0)throw new TypeError("CarouselPagingProvider instance variable ".concat(t," failed type check with value ").concat(e," for locationId ").concat(i.props.locationId))}),g()(f()(f()(i)),"wasJustInitialized",void 0),g()(f()(f()(i)),"totalPhotoCount",void 0),g()(f()(f()(i)),"panoCount",void 0),g()(f()(f()(i)),"favouritePhotoCount",void 0),g()(f()(f()(i)),"loadedPhotoCount",void 0),g()(f()(f()(i)),"photos",void 0),g()(f()(f()(i)),"shouldSaveReduxState",!1),g()(f()(f()(i)),"renderWithNewPhotos",function(e,t){return N.createElement(y.a,{data:t,identifier:function e(t){return String(t.id)}},function(t){return e||(i.wasJustInitialized=!1,i.photos=t),i.props.children({loading:e,photos:i.photos,photoCount:i.totalPhotoCount||0,panoCount:i.panoCount||0,getNextPage:e?function(){}:i.getNextPage})})});var n=i.props.fetchOnFirstLoad;i.wasJustInitialized=!0,i.totalPhotoCount=null,i.panoCount=null;var o=n;if(i.favouritePhotoCount=null,i.loadedPhotoCount=0,i.photos=[],i.props.saveReduxState){var d=i.getUniqueId(),u=_(d);i.totalPhotoCount=C()(u,"totalPhotoCount",null),i.panoCount=C()(u,"panoCount",null),o=C()(u,"fetchTarget",n),i.favouritePhotoCount=C()(u,"favouritePhotoCount",null),i.loadedPhotoCount=C()(u,"loadedPhotoCount",0),i.photos=C()(u,"photos",[])}return i.state={fetchTarget:o},i}return k()(t,e),u()(t,[{key:"shouldComponentUpdate",value:function e(){return null!==this.getNextQueryParams()}},{key:"componentDidUpdate",value:function e(){this.props.saveReduxState&&this.shouldSaveReduxState&&(this.shouldSaveReduxState=!1,Object(P.getStore)().dispatch(function e(t,i,n,a,o,l,d){return z.action({type:"registerState",uniqueId:t,totalPhotoCount:i,panoCount:n,fetchTarget:a,favouritePhotoCount:o,loadedPhotoCount:l,photos:d})}(this.getUniqueId(),this.totalPhotoCount,this.panoCount,this.state.fetchTarget,this.favouritePhotoCount,this.loadedPhotoCount,this.photos)))}},{key:"render",value:function e(){var t=this;if(this.props.locationId<0)return this.props.children({loading:!1,photos:[],photoCount:0,panoCount:0,getNextPage:function e(){}});var i=this.shouldUseFavouritesQuery()?w:E,n=this.getNextQueryParams();return N.createElement(b.Query,{query:i,variables:n,ssr:!this.props.clientOnly},function(e){var i=e.loading,n=e.data;return t.renderWithNewPhotos(i,t.parseQueryData(i,n))})}}]),t}(N.Component);g()(L,"defaultProps",{pageSize:10,fetchOnFirstLoad:10});var U=L,W=i("@ta/media.image"),M=i("@ta/styleguide.icon"),G=i("@ta/styleguide.skeleton"),J=i.n(G),Z=i("@ta/common.i18n"),$=function e(t){var i=t.photoSizes,n=t.title,a=t.count,o=t.onClick,l=t.heightOverride;return N.createElement("div",{style:l?{height:l}:null,className:"hotels-photos-AlbumThumbnail__albumThumb--owUAM",onClick:i.length>0?o:null},N.createElement("div",{className:"hotels-photos-AlbumThumbnail__inner--1A04b"},0===i.length?N.createElement(J.a,{height:"100%"}):N.createElement(N.Fragment,null,N.createElement(W.ResponsiveImage,{sources:i,height:"100%",width:"100%"}),N.createElement("span",{className:"hotels-photos-AlbumThumbnail__info--1M9he"},N.createElement(M.Icon,{name:"camera",className:"hotels-photos-AlbumThumbnail__icon--bbnxN"}),n," (",Z.globalize.formatNumber("integer",a),")"))))},B=i("./packages/hotels/photos/FavouritePhotos.fragment.gql"),H={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"FavouritePhotosQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"locationId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"offset"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},defaultValue:{kind:"IntValue",value:"0"},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"limit"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},defaultValue:{kind:"IntValue",value:"10"},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"locations"},arguments:[{kind:"Argument",name:{kind:"Name",value:"locationIds"},value:{kind:"ListValue",values:[{kind:"Variable",name:{kind:"Name",value:"locationId"}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"locationId"},arguments:[],directives:[]},{kind:"FragmentSpread",name:{kind:"Name",value:"FavouritePhotos"},directives:[]}]}}]}}],loc:{start:0,end:213}};H.loc.source={body:"84d08306d0d8"};var K={};H.definitions=H.definitions.concat(function X(e){return e.filter(function(e){if("FragmentDefinition"!==e.kind)return!0;var t=e.name.value;return!K[t]&&(K[t]=!0,!0)})}(B.a.definitions));var Y=H,ee=i("@ta/common.cdn"),te=i.n(ee),ie=N.memo(te()(function e(t){var i=t.url,n=t.className,a=t.imgCdnUrl,o={url:"".concat(a).concat(i),width:200,height:200};return N.createElement("div",{className:n||"hotels-photos-ResponsiveDefaultImage__full--16hw3"},N.createElement(W.ResponsiveImage,{sources:[o],width:"100%",height:"100%"}))}));i.d(t,"CarouselPagingProvider",function(){return U}),i.d(t,"PAGE_SIZE",function(){return 10}),i.d(t,"AlbumThumbnail",function(){return $}),i.d(t,"FavouritePhotosQuery",function(){return Y}),i.d(t,"FavouritePhotosWithPanoCountQuery",function(){return w}),i.d(t,"OrderedPhotosQuery",function(){return E}),i.d(t,"ResponsiveDefaultImage",function(){return ie})}}});
//# sourceMappingURL=hotels.photos.9d9e180559.js.map